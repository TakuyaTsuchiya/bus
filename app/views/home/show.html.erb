<h1>レインボーバス時刻表</h1>

現在の時刻: <%= Time.zone.now %>

<div data-component-name="BusForm" data-component-props=<%= { actionUrl: root_path, busStops: @bus_stops.map { |bus_stop| { id: bus_stop.id, name: bus_stop.name }}, selectedStartBusStopId: @start_bus_stop&.id, selectedEndBusStopId: @end_bus_stop&.id }.to_json %>>
</div>

<hr />

<table>
  <tbody>
  <%- @bus_stops.each do |stop| %>
    <tr>
      <td>
        <%= stop.name %>
      </td>

      <%- @bus_flows.each do |flow| %>
        <td>
          <%- order = @bus_stop_orders.find_by(bus_flows: flow, bus_stop: stop) %>
          <%- if order %>
            <%= order.arrived_time.strftime("%H:%M") %>

            <% if order == @target_order %>
              これやで
            <% end %>
          <% else %>
            ↓
          <% end %>
        </td>
      <% end %>
    </tr>
  <% end %>
  </tbody>
</table>